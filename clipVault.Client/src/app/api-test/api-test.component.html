<mat-sidenav-container class="api-test-sidenav-container">
  <mat-sidenav mode="side" opened class="api-test-sidenav">
    <div class="sidenav-title">API Tests</div>
    <button mat-button class="sidenav-btn" [class.active]="selectedApi === 'getThumbnail'" (click)="selectApi('getThumbnail')">
      Get Thumbnail
    </button>
    <button mat-button class="sidenav-btn" [class.active]="selectedApi === 'uploadVideo'" (click)="selectApi('uploadVideo')">
      Upload Video
    </button>
    <button mat-button class="sidenav-btn" [class.active]="selectedApi === 'getVideoCategories'" (click)="selectApi('getVideoCategories')">
      Get Video Categories
    </button>
  </mat-sidenav>

  <mat-sidenav-content class="api-test-content">
    <div *ngIf="selectedApi === 'getThumbnail'" class="api-form-section">
      <h2>Get Thumbnail</h2>
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Thumbnail ID</mat-label>
        <input matInput [(ngModel)]="thumbnailId" placeholder="Enter thumbnail ID">
      </mat-form-field>
      <button mat-raised-button color="primary" (click)="getThumbnail(thumbnailId)">
        Get Thumbnail
      </button>
      <div *ngIf="getThumbnailLoading" class="loading-indicator">
        <mat-spinner diameter="40"></mat-spinner>
      </div>
      <div *ngIf="getThumbnailError" class="error-message">
        {{ getThumbnailError }}
      </div>
      <div *ngIf="!getThumbnailLoading && !getThumbnailError && title">
        <h3>{{ title }}</h3>
        <div *ngIf="imageDataUrl" class="thumbnail-image-container">
          <img [src]="imageDataUrl" alt="Thumbnail" class="thumbnail-image">
        </div>
        <div *ngIf="friendTags.length > 0" class="tags-section">
          <strong>Friend Tags:</strong>
          <span> {{friendTags}} </span>
        </div>
      </div>
    </div>

    <div *ngIf="selectedApi === 'uploadVideo'" class="api-form-section">
      <h2>Upload Video</h2>
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Video Title</mat-label>
        <input matInput [(ngModel)]="uploadTitle" placeholder="Enter video title">
      </mat-form-field>
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Friend Tags (comma-separated)</mat-label>
        <input matInput [(ngModel)]="uploadFriendTagsInput" placeholder="e.g., John, Jane">
      </mat-form-field>
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Category</mat-label>
        <mat-select [(ngModel)]="uploadSelectedCategoryId" name="categorySelect">
          <mat-option *ngFor="let cat of uploadCategories" [value]="cat.id">
            {{ cat.categoryName }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Category Tags (comma-separated)</mat-label>
        <input matInput [(ngModel)]="uploadCategoryIdsInput" placeholder="e.g., Nature, Travel">
      </mat-form-field>
      <input type="file" (change)="onFileSelected($event)" accept="video/*">
      <button mat-raised-button color="accent" (click)="uploadVideo()" [disabled]="!selectedFile || uploadVideoLoading">
        Upload Video
      </button>
      <mat-progress-bar *ngIf="uploadVideoLoading" mode="indeterminate"></mat-progress-bar>
      <div *ngIf="uploadVideoError" class="error-message">
        {{ uploadVideoError }}
      </div>
    </div>

    <div *ngIf="selectedApi === 'getVideoCategories'" class="api-form-section">
      <h2>Get Video Categories</h2>
      <button mat-raised-button color="primary" (click)="getVideoCategories()">
        Fetch Categories
      </button>
      <div *ngIf="getCategoriesLoading" class="loading-indicator">
        <mat-spinner diameter="40"></mat-spinner>
      </div>
      <div *ngIf="getCategoriesError" class="error-message">
        {{ getCategoriesError }}
      </div>
      <div *ngIf="!getCategoriesLoading && videoCategories.length > 0" class="categories-list">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Rating</th>
              <th>Image ID</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let cat of videoCategories">
              <td>{{cat.id}}</td>
              <td>{{cat.categoryName}}</td>
              <td>{{cat.rating}}</td>
              <td>{{cat.imageId || '-'}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
